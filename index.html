<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>YT-Playlist • Shuffle • Loop (ES5)</title>
<style>
  html,body{margin:0;height:100%;background:#000;overflow:hidden}
  #player{position:absolute;top:0;left:0;width:100%;height:100%}
</style>

<!-- YouTube-iFrame-API -->
<script src="https://www.youtube.com/iframe_api"></script>
<script>
/* ==== HIER DEINE PLAYLIST-ID ==== */
var PLAYLIST = 'PLcqnA2uUrX6YHmWp3rd3N0CLLQRr7SHKC';
/* ================================ */

var player;
var watchdog;

/* 1) Wird von der API aufgerufen, sobald sie geladen ist */
function onYouTubeIframeAPIReady(){
  player = new YT.Player('player',{
    playerVars:{
      listType:'playlist',
      list:PLAYLIST,
      autoplay:1,
      loop:1,
      playlist:PLAYLIST,
      mute:1,
      controls:0,
      disablekb:1,
      fs:0,
      modestbranding:1
    },
    events:{
      'onReady': onPlayerReady,
      'onStateChange': onPlayerStateChange
    }
  });
}

/* 2) Player ist bereit  */
function onPlayerReady(e){
  e.target.playVideo();      // falls Autoplay geblockt wird
  e.target.setShuffle(true); // Shuffle aktivieren
  // Ton erst nach 5 s einschalten → Autoplay-Blockade umgehen
  setTimeout(function(){ e.target.unMute(); }, 5000);
}

/* 3) Nie stehen bleiben */
function onPlayerStateChange(e){
  var st = e.data;
  if(st === 2){                    // 2 = PAUSED
    setTimeout(function(){ player.playVideo(); }, 500);
  }
  if(st === 0){                    // 0 = ENDED
    player.setShuffle(true);       // Shuffle erneut setzen
  }
}

/* 4) „Wachhund“: alle 2 min Play, falls etwas hängt */
watchdog = setInterval(function(){
  if(player && player.getPlayerState && player.getPlayerState() !== 1){
    player.playVideo();
  }
}, 120000);
</script>
</head>
<body>
  <div id="player"></div>
</body>
</html>
